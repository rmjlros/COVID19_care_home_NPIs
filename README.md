# COVID19_care_home_NPIs

Data and `R` code to support Rosello *et al.*, (2021). Impact of non-pharmaceutical interventions on SARS-CoV-2 outbreaks in English care homes: a modelling study. *BMC Infectious Diseases* (submitted). 


--------------------------------------------------------------------------------
  
### Study description

  This study simulates SARS-CoV-2 transmission in an English care home and evaluates the probability of an outbreak over time for a care home with non-pharmaceutical interventions (NPIs) already in place. The model includes resident hospitalisation, testing of residents and staff, isolation of residents, absence and replacement of staff, and resident death. 
  
  The authors evaluate the relative importance of the different routes of importation to the care home: from hospital through the hospitalisation of residents, from the community through visitors, and from the community through staff. They also address the impact of additional control measures, namely: increasing staff and resident testing frequency, using lateral flow antigen testing tests instead of PCR, enhancing infection prevention and control, increasing the proportion of residents isolated, shortening the delay to isolation, improving the effectiveness of isolation, restricting visitors and limiting staff to working in one care home.

--------------------------------------------------------------------------------
  
### Repository files

  A description of each file and folder is provided below. 
  
  
**Sourced scripts**


  All script names starting by `00_` denote scrips that are not to be run alone but are sourced by other scripts. 

* **`00_prep_data.R`:** `R` script to read in publicly available data and format it. Unpublished data was analysed separately, the results of which are provided hard-coded only for the dates required.

* **`00_prep_parameter_means.R`:** `R` script to define parameter means and fixed parameter values.

* **`00_prep_parameter_draws.R`:** `R` script to draw parameters from distributions, define extreme parameter values for sensitivity analysis, and aggregate parameters into matrix.

* **`00_prep_parameter_combo.R`:** `R` script to combine parameters.

* **`00_prep_run_name.R`:** `R` script to name a model run.

* **`00_prep_baseline_parameters.R`:** `R` script to define the parameters of the baseline scenario.

* **`00_prep_parameter_scenario_dependencies.R`:** `R` script to define parameters of the selected scenario.

* **`00_initialiser.R`:** `R` script to define initial conditions of model simulation.

* **`00_model.R`:** `R` script to define transmission model.

* **`00_model_function_uncertainty.R`:** `R` script to define a function that runs model and outputs results with uncertainty.


**Scripts to run**


  `01_run_parameter_sets.R` outputs the parameter sets which are read in by all script names starting by `02_`. Script names starting by `02_`, in turn, output model results which are then read in by script names starting by `03_`. Scripts names starting by `03_` output the paper figures. 


* **`01_run_parameter_sets.R`:** `R` script that runs parameter sets and outputs these to `Outputs/Params`.

* **`02_run_model_with_uncertainty_scenarios.R`:** `R` script that runs model and outputs results for all scenarios with uncertainty, stored in `Outputs/Model`. This script reads in the parameter sets outputted by `01_run_parameter_sets.R`. 

* **`02_run_model_with_uncertainty_tests.R`:** `R` script that runs model and outputs results for all testing strategies considered with uncertainty, stored in `Outputs/Model`. This script reads in the parameter sets outputted by `01_run_parameter_sets.R`.

* **`02_run_model_with_uncertainty_IPC_other.R`:** `R` script that runs model and outputs results for all other IPC strategies considered with uncertainty, stored in `Outputs/Model`. This script reads in the parameter sets outputted by running `01_run_parameter_sets.R`.

* **`03_figure_2.R`:** `R` script that plots Figure 2, stored in `Plots`. This script reads in model results outputted by  `02_run_model_with_uncertainty_scenarios.R`.

* **`03_figure_3.R`:** `R` script that plots Figure 3, stored in `Plots`. This script reads in model results outputted by  `02_run_model_with_uncertainty_scenarios.R`.

* **`03_figure_4.R`:** `R` script that plots Figure 4, stored in `Plots`. This script reads in model results outputted by  `02_run_model_with_uncertainty_tests.R`.

* **`03_figure_5.R`:** `R` script that plots Figure 5, stored in `Plots`. This script reads in model results outputted by  `02_run_model_with_uncertainty_IPC_other.R`.


**Folders**

* **`Data`:** a folder containing the public data needed for analysis. Note that SUS data is not public and therefore has not been included here. 

* **`Outputs`:** a folder to save the model outputs generated by the `R` scripts. 

* **`Plots`:** a folder to save the figures generated by the `R` scripts.


**Project**

* **`COVID19_care_home_NPIs.Rproj`:** An `RStudio` project file, to avoid having to set your working directory to the  folder on your computer. 


--------------------------------------------------------------------------------

Download the repository as a ZIP file using the green button *Clone or download* above, then open the .Rproj file in `RStudio` to begin. 

The analysis was performed using R version 3.6.2 (2019-12-12).

For any issues with the code please contact [Alicia Rosell√≥](https://www.lshtm.ac.uk/aboutus/people/rosello.alicia).
